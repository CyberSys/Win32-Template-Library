//////////////////////////////////////////////////////////////////////////////////////////
//! \file wtl\io\Console.cpp
//! \brief Provides storage for the debug console stream
//! \date 30 November 2015
//! \author Nick Crowley
//! \copyright © Nick Crowley. All rights reserved.
//////////////////////////////////////////////////////////////////////////////////////////
#include <wtl/io/Console.hpp>           //!< console_stream

//////////////////////////////////////////////////////////////////////////////////////////
//! \namespace wtl - Windows template library
//////////////////////////////////////////////////////////////////////////////////////////
namespace wtl
{
  
  //////////////////////////////////////////////////////////////////////////////////////////
  //! \struct console_window - Allocates a process-wide console
  //////////////////////////////////////////////////////////////////////////////////////////
  struct console_window 
  {
    // ---------------------------------- TYPES & CONSTANTS ---------------------------------

    // ----------------------------------- REPRESENTATION -----------------------------------
    
    // ------------------------------------ CONSTRUCTION ------------------------------------
    
    //////////////////////////////////////////////////////////////////////////////////////////
    // console_window::console_window
    //! Allocates a new console for the calling process 
    //!
    //! \throw std::runtime_error - Unable to allocate console
    //////////////////////////////////////////////////////////////////////////////////////////
    console_window() 
    {
      if (!::AllocConsole())
        throw std::runtime_error("Unable to allocate console");
    }
    
    //////////////////////////////////////////////////////////////////////////////////////////
    // console_window::~console_window
    //! Free the console 
    //////////////////////////////////////////////////////////////////////////////////////////
    ~console_window() 
    {
      ::FreeConsole();
    }
    
    // -------------------------------- COPY, MOVE & DESTROY --------------------------------
    
    // ----------------------------------- STATIC METHODS -----------------------------------
    
    // ---------------------------------- ACCESSOR METHODS ----------------------------------
    
    // ----------------------------------- MUTATOR METHODS ----------------------------------

  };

  
  //////////////////////////////////////////////////////////////////////////////////////////
  //! \var cwindow - Allocates process console
  //////////////////////////////////////////////////////////////////////////////////////////
  console_window cwindow;

  //////////////////////////////////////////////////////////////////////////////////////////
  //! \var cdebug - Narrow character debug console stream
  //////////////////////////////////////////////////////////////////////////////////////////
  console cdebug;

  

}



